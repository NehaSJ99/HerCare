{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Lenovo\\\\Downloads\\\\HerCare\\\\frontend\\\\src\\\\pages\\\\VideoCallPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VideoCallPage = () => {\n  _s();\n  const {\n    roomCode\n  } = useParams(); // Get the roomCode from the URL\n  const [isCallStarted, setIsCallStarted] = useState(false);\n  const localVideoRef = useRef(null);\n  const remoteVideoRef = useRef(null);\n  const [peerConnection, setPeerConnection] = useState(null);\n  const [localStream, setLocalStream] = useState(null);\n\n  // Constants for WebRTC signaling (may need a signaling server like Socket.IO for production)\n  const ICE_SERVERS = {\n    iceServers: [{\n      urls: 'stun:stun.l.google.com:19302' // Google's public STUN server\n    }]\n  };\n\n  // Function to get media (camera & microphone)\n  const getUserMedia = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      setLocalStream(stream);\n      if (localVideoRef.current) {\n        localVideoRef.current.srcObject = stream;\n      }\n    } catch (error) {\n      console.error('Error accessing media devices.', error);\n    }\n  };\n  useEffect(() => {\n    // Request permissions and set up the media stream\n    getUserMedia();\n    return () => {\n      // Clean up the stream when the component unmounts\n      if (localStream) {\n        localStream.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, []);\n  const startCall = () => {\n    if (!localStream) {\n      console.error('Local stream is not available!');\n      return;\n    }\n    const pc = new RTCPeerConnection(ICE_SERVERS);\n    setPeerConnection(pc);\n\n    // Add local stream to the peer connection\n    localStream.getTracks().forEach(track => pc.addTrack(track, localStream));\n\n    // When remote stream is added to the connection, show it on the remote video element\n    pc.ontrack = event => {\n      if (remoteVideoRef.current) {\n        remoteVideoRef.current.srcObject = event.streams[0];\n      }\n    };\n\n    // Create an offer and set it as the local description\n    pc.createOffer().then(offer => pc.setLocalDescription(offer)).then(() => {\n      // Send the offer to the remote peer (via a signaling server)\n      // This is where you'd send the offer to the server and to the other client\n      console.log('Offer sent:', pc.localDescription);\n    }).catch(err => console.error('Error creating offer:', err));\n    setIsCallStarted(true);\n  };\n  const endCall = () => {\n    if (peerConnection) {\n      peerConnection.close();\n      setPeerConnection(null);\n    }\n    if (localStream) {\n      localStream.getTracks().forEach(track => track.stop());\n    }\n    setIsCallStarted(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex justify-center items-center h-screen bg-gray-100\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full max-w-4xl bg-white shadow-lg rounded-lg p-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"text-xl font-semibold mb-4\",\n        children: [\"Video Call - Room: \", roomCode]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-1/2 mr-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-center\",\n            children: \"Your Video\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: localVideoRef,\n            autoPlay: true,\n            muted: true,\n            className: \"w-full rounded-lg shadow-md\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-1/2 ml-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            className: \"text-center\",\n            children: \"Remote Video\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n            ref: remoteVideoRef,\n            autoPlay: true,\n            className: \"w-full rounded-lg shadow-md\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-center space-x-4\",\n        children: !isCallStarted ? /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startCall,\n          className: \"bg-green-500 text-white py-2 px-4 rounded-md\",\n          children: \"Start Call\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: endCall,\n          className: \"bg-red-500 text-white py-2 px-4 rounded-md\",\n          children: \"End Call\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 9\n  }, this);\n};\n_s(VideoCallPage, \"y+YFRbH16D85NxYzXxeEqqhJryk=\", false, function () {\n  return [useParams];\n});\n_c = VideoCallPage;\nexport default VideoCallPage;\nvar _c;\n$RefreshReg$(_c, \"VideoCallPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","jsxDEV","_jsxDEV","VideoCallPage","_s","roomCode","isCallStarted","setIsCallStarted","localVideoRef","remoteVideoRef","peerConnection","setPeerConnection","localStream","setLocalStream","ICE_SERVERS","iceServers","urls","getUserMedia","stream","navigator","mediaDevices","video","audio","current","srcObject","error","console","getTracks","forEach","track","stop","startCall","pc","RTCPeerConnection","addTrack","ontrack","event","streams","createOffer","then","offer","setLocalDescription","log","localDescription","catch","err","endCall","close","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","muted","onClick","_c","$RefreshReg$"],"sources":["C:/Users/Lenovo/Downloads/HerCare/frontend/src/pages/VideoCallPage.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\n\r\nconst VideoCallPage = () => {\r\n    const { roomCode } = useParams(); // Get the roomCode from the URL\r\n    const [isCallStarted, setIsCallStarted] = useState(false);\r\n    const localVideoRef = useRef(null);\r\n    const remoteVideoRef = useRef(null);\r\n    const [peerConnection, setPeerConnection] = useState(null);\r\n    const [localStream, setLocalStream] = useState(null);\r\n\r\n    // Constants for WebRTC signaling (may need a signaling server like Socket.IO for production)\r\n    const ICE_SERVERS = {\r\n        iceServers: [\r\n            {\r\n                urls: 'stun:stun.l.google.com:19302', // Google's public STUN server\r\n            },\r\n        ],\r\n    };\r\n\r\n    // Function to get media (camera & microphone)\r\n    const getUserMedia = async () => {\r\n        try {\r\n            const stream = await navigator.mediaDevices.getUserMedia({\r\n                video: true,\r\n                audio: true,\r\n            });\r\n\r\n            setLocalStream(stream);\r\n\r\n            if (localVideoRef.current) {\r\n                localVideoRef.current.srcObject = stream;\r\n            }\r\n        } catch (error) {\r\n            console.error('Error accessing media devices.', error);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Request permissions and set up the media stream\r\n        getUserMedia();\r\n\r\n        return () => {\r\n            // Clean up the stream when the component unmounts\r\n            if (localStream) {\r\n                localStream.getTracks().forEach(track => track.stop());\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    const startCall = () => {\r\n        if (!localStream) {\r\n            console.error('Local stream is not available!');\r\n            return;\r\n        }\r\n\r\n        const pc = new RTCPeerConnection(ICE_SERVERS);\r\n        setPeerConnection(pc);\r\n\r\n        // Add local stream to the peer connection\r\n        localStream.getTracks().forEach(track => pc.addTrack(track, localStream));\r\n\r\n        // When remote stream is added to the connection, show it on the remote video element\r\n        pc.ontrack = (event) => {\r\n            if (remoteVideoRef.current) {\r\n                remoteVideoRef.current.srcObject = event.streams[0];\r\n            }\r\n        };\r\n\r\n        // Create an offer and set it as the local description\r\n        pc.createOffer()\r\n            .then(offer => pc.setLocalDescription(offer))\r\n            .then(() => {\r\n                // Send the offer to the remote peer (via a signaling server)\r\n                // This is where you'd send the offer to the server and to the other client\r\n                console.log('Offer sent:', pc.localDescription);\r\n            })\r\n            .catch(err => console.error('Error creating offer:', err));\r\n\r\n        setIsCallStarted(true);\r\n    };\r\n\r\n    const endCall = () => {\r\n        if (peerConnection) {\r\n            peerConnection.close();\r\n            setPeerConnection(null);\r\n        }\r\n        if (localStream) {\r\n            localStream.getTracks().forEach(track => track.stop());\r\n        }\r\n        setIsCallStarted(false);\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex justify-center items-center h-screen bg-gray-100\">\r\n            <div className=\"w-full max-w-4xl bg-white shadow-lg rounded-lg p-4\">\r\n                <h1 className=\"text-xl font-semibold mb-4\">Video Call - Room: {roomCode}</h1>\r\n\r\n                <div className=\"flex justify-between mb-4\">\r\n                    <div className=\"w-1/2 mr-2\">\r\n                        <h2 className=\"text-center\">Your Video</h2>\r\n                        <video\r\n                            ref={localVideoRef}\r\n                            autoPlay\r\n                            muted\r\n                            className=\"w-full rounded-lg shadow-md\"\r\n                        ></video>\r\n                    </div>\r\n                    <div className=\"w-1/2 ml-2\">\r\n                        <h2 className=\"text-center\">Remote Video</h2>\r\n                        <video\r\n                            ref={remoteVideoRef}\r\n                            autoPlay\r\n                            className=\"w-full rounded-lg shadow-md\"\r\n                        ></video>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex justify-center space-x-4\">\r\n                    {!isCallStarted ? (\r\n                        <button\r\n                            onClick={startCall}\r\n                            className=\"bg-green-500 text-white py-2 px-4 rounded-md\"\r\n                        >\r\n                            Start Call\r\n                        </button>\r\n                    ) : (\r\n                        <button\r\n                            onClick={endCall}\r\n                            className=\"bg-red-500 text-white py-2 px-4 rounded-md\"\r\n                        >\r\n                            End Call\r\n                        </button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VideoCallPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}